"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function initForm(){var e='<div style="padding: 10px;background: #fff;position: absolute;width: 90%;top: 34%;z-index:999;"><div style="text-align: center;padding: 5px;line-height: 2em;border-bottom: 1px solid #ccc;position: relative;"><div>日志系统</div><div id="log_close" style="position: absolute;right: 10px;top: 5px;color: #999;">关闭</div></div><div style="padding: 5px;"><div style="display: flex;"><span>Inspect:</span><div style="flex: 1;padding: 0 10px;"><input id="log_server" type="text" style="width: 95%;" /></div><a id="log_inspect" style="width: 80px;text-align: center;background: #44f;border-radius: 3px;color: #fff;">Add</a></div></div></div>',t=document.createElement("div"),n=this;t.style.display="none",t.innerHTML=e,document.body.appendChild(t),this.logNode=t,document.getElementById("log_close").addEventListener("click",function(){n.closePop()},!1),document.getElementById("log_inspect").addEventListener("click",function(){if(n.data.inspected)n.removeInspect();else{var e=document.getElementById("log_server").value;n.save({server:e}),n.openInspect()}},!1)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Reporter=function(){function e(t){_classCallCheck(this,e);var n=localStorage.getItem("logData");this.data=n?JSON.parse(n):{devMod:!0,inspected:!1},this.save(t),initForm.call(this),this.data.devMod&&this.openDev(),this.data.inspected&&this.openInspect()}return _createClass(e,[{key:"save",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t in e)this.data[t]=e[t];localStorage.setItem("logData",JSON.stringify(this.data))}},{key:"send",value:function(e){console.log(e.name),console.log(e.stack),console.log(e.message)}},{key:"listen",value:function(){console.log("启动监听"),this.stop=function(){}}},{key:"view",value:function(){console.log("查看日志"),this.logNode.style.display="block",this.data.inspected?document.getElementById("log_inspect").innerHTML="Remove":document.getElementById("log_inspect").innerHTML="Add"}},{key:"closePop",value:function(){console.log("关闭查看窗口"),this.logNode.style.display="none"}},{key:"openDev",value:function(){function e(e){n++,n>5&&t.view(),o||(o=window.setTimeout(function(){n=0,clearTimeout(o),o=null},1e3))}var t=this,n=0,o=void 0;document.body.addEventListener("click",e,!1),this.closeDev=function(){document.body.removeEventListener("click",e,!1)}}},{key:"openInspect",value:function(){var e=this;if(console.log("打开inspect"),this.data.server){var t=document.createElement("script");t.src=this.data.server+"/target/target-script-min.js#anonymous",document.body.appendChild(t),this.closePop(),this.save({inspected:!0}),this.removeInspect=function(){console.log("移除inspect"),t.remove(),e.save({inspected:!1}),document.getElementById("log_inspect").innerHTML="Add"}}}}]),e}();exports.default=Reporter;